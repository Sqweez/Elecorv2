(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"+F2W":function(t,e,n){"use strict";var o={props:{state:{type:Boolean,default:!1},title:{type:String,default:"Подтвердите действие"},message:{type:String,required:!0},okMessage:{type:String,default:"ОК"},cancelMessage:{type:String,default:"Отмена"}},methods:{onConfirm:function(){this.$emit("confirm")},onCancel:function(){this.$emit("cancel")}}},a=(n("dXLZ"),n("KHd+")),i=Object(a.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-dialog",{attrs:{persistent:"",width:"500"},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[n("v-card",[n("v-card-title",{staticClass:"headline blue darken-1 justify-content-between"},[n("span",{staticClass:"white--text"},[t._v(t._s(t.title))]),t._v(" "),n("v-btn",{staticClass:"float-right",attrs:{icon:"",text:""}},[n("v-icon",{attrs:{color:"white"},on:{click:t.onCancel}},[t._v("\n                        mdi-close\n                    ")])],1)],1),t._v(" "),n("v-card-text",{staticClass:"modal-text"},[t._v("\n                "+t._s(t.message)+"\n            ")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{text:""},on:{click:t.onCancel}},[t._v("\n                    "+t._s(t.cancelMessage)+"\n                ")]),t._v(" "),n("v-btn",{attrs:{color:"success",text:""},on:{click:t.onConfirm}},[t._v("\n                    "+t._s(t.okMessage)+"\n                    "),n("v-icon",[t._v("mdi-check")])],1)],1)],1)],1)],1)}),[],!1,null,"2adaa561",null);e.a=i.exports},F3ox:function(t,e,n){var o=n("toHN");"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(o,a);o.locals&&(t.exports=o.locals)},HKfM:function(t,e,n){"use strict";var o=n("o0o1"),a=n.n(o),i=n("+z1p"),s=n.n(i),r=(n("GVEN"),n("ootA")),c=n("6cC8");function l(t,e,n,o,a,i,s){try{var r=t[i](s),c=r.value}catch(t){return void n(t)}r.done?e(c):Promise.resolve(c).then(o,a)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){l(i,o,a,s,r,"next",t)}function r(t){l(i,o,a,s,r,"throw",t)}s(void 0)}))}}var u={props:{state:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},title:{type:String,default:"Добавление новости"},okButton:{type:String,default:"Создать"},serviceId:{type:Number,default:null}},watch:{state:function(t){var e=this;return d(a.a.mark((function n(){var o;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t||!e.editMode||null===e.serviceId){n.next=9;break}return n.next=3,e.$store.getters.stock(e.serviceId);case 3:o=n.sent,e.stock.title=o.title,e.stock.body=o.body||"",e.stock.image=o.image,e.stockType=null==o.service_id?"stock":"banner",e.stock.service_id=o.service_id;case 9:case"end":return n.stop()}}),n)})))()}},data:function(){return{loading:!1,editor:s.a,stockType:"stock",editorConfig:{language:"ru",height:700,autoGrow_minHeight:400},stock:{title:"",body:"",image:null,service_id:null}}},computed:{services:function(){return this.$store.getters.getMobileServices}},methods:{onSubmit:function(){var t=this;return d(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.editMode){e.next=5;break}return e.next=3,t.editStock();case 3:e.next=7;break;case 5:return e.next=7,t.createStock();case 7:case"end":return e.stop()}}),e)})))()},editStock:function(){var t=this;return d(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,t.stock.service_id="banner"===t.stockType?t.stock.service_id:null,t.stock.body="stock"===t.stockType?t.stock.body:null,e.next=5,t.$store.dispatch(c.a.EDIT_STOCK,{id:t.serviceId,image:t.stock.image,body:t.stock.body||null,title:t.stock.title,service_id:t.stock.service_id});case 5:t.$emit("onSave"),t.clearData();case 7:case"end":return e.stop()}}),e)})))()},createStock:function(){var t=this;return d(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,t.stock.service_id="banner"===t.stockType?t.stock.service_id:null,t.stock.body="stock"===t.stockType?t.stock.body:null,e.next=5,t.$store.dispatch(c.a.CREATE_STOCK,{image:t.stock.image,body:t.stock.body,title:t.stock.title,service_id:t.stock.service_id});case 5:t.$emit("onSave"),t.clearData();case 7:case"end":return e.stop()}}),e)})))()},choosePhoto:function(){this.$refs.fileInput.click()},uploadPhoto:function(t){var e=this;return d(a.a.mark((function n(){var o;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(r.a)(t.target.files[0]);case 2:o=n.sent,e.stock.image=o.data;case 4:case"end":return n.stop()}}),n)})))()},clearData:function(){this.stock={title:"",body:"",image:null,service_id:null},this.stockType="stock",this.loading=!1}}},v=n("KHd+"),f=Object(v.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{"max-width":"800",persistent:""},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[n("v-card",[n("v-card-title",{staticClass:"headline blue darken-1 justify-content-between"},[n("span",{staticClass:"white--text"},[t._v(t._s(t.title))]),t._v(" "),n("v-btn",{staticClass:"float-right",attrs:{icon:"",text:""},on:{click:function(e){return t.$emit("onClose")}}},[n("v-icon",{attrs:{color:"white"}},[t._v("\n                    mdi-close\n                ")])],1)],1),t._v(" "),n("v-card-text",[t.loading?t._e():n("v-form",{staticClass:"p-2"},[n("v-text-field",{attrs:{label:"Заголовок"},model:{value:t.stock.title,callback:function(e){t.$set(t.stock,"title",e)},expression:"stock.title"}}),t._v(" "),n("v-radio-group",{model:{value:t.stockType,callback:function(e){t.stockType=e},expression:"stockType"}},[n("v-radio",{key:"1",attrs:{label:"Акция",value:"stock"}}),t._v(" "),n("v-radio",{key:"2",attrs:{label:"Баннер",value:"banner"}})],1),t._v(" "),"stock"===t.stockType?n("div",[n("ckeditor",{attrs:{editor:t.editor,config:t.editorConfig,rows:"10"},model:{value:t.stock.body,callback:function(e){t.$set(t.stock,"body",e)},expression:"stock.body"}})],1):t._e(),t._v(" "),"banner"===t.stockType?n("v-select",{attrs:{items:t.services,"item-text":"name","item-value":"id"},model:{value:t.stock.service_id,callback:function(e){t.$set(t.stock,"service_id",e)},expression:"stock.service_id"}}):t._e(),t._v(" "),n("input",{ref:"fileInput",staticClass:"d-none",attrs:{type:"file"},on:{change:t.uploadPhoto}}),t._v(" "),t.stock.image?n("img",{staticClass:"mt-2 mb-2",staticStyle:{"max-width":"400px",height:"auto"},attrs:{src:"../storage/"+t.stock.image,alt:""}}):t._e(),t._v(" "),n("div",[n("v-btn",{staticClass:"mt-4",attrs:{color:"primary","max-width":"400"},on:{click:t.choosePhoto}},[t._v("Загрузите фото\n                        "),n("v-icon",{staticClass:"ml-2"},[t._v("mdi-upload")])],1)],1)],1)],1),t._v(" "),n("v-divider"),t._v(" "),t.loading?t._e():n("v-card-actions",[n("v-btn",{attrs:{text:""},on:{click:function(e){return t.$emit("onClose")}}},[t._v("Отмена")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{text:"",color:"success",disabled:null===t.stock.image},on:{click:t.onSubmit}},[n("b",[t._v(t._s(t.okButton))]),t._v(" "),n("v-icon",[t._v("mdi-check")])],1)],1),t._v(" "),n("v-progress-linear",{attrs:{indeterminate:"",active:t.loading,color:"green",absolute:"",bottom:""}})],1)],1)}),[],!1,null,"d25f9e90",null);e.a=f.exports},dXLZ:function(t,e,n){"use strict";n("F3ox")},kxSr:function(t,e,n){"use strict";var o=n("o0o1"),a=n.n(o),i=n("BWV3"),s=n("HKfM"),r=n("+F2W"),c=n("6cC8");function l(t,e,n,o,a,i,s){try{var r=t[i](s),c=r.value}catch(t){return void n(t)}r.done?e(c):Promise.resolve(c).then(o,a)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){l(i,o,a,s,r,"next",t)}function r(t){l(i,o,a,s,r,"throw",t)}s(void 0)}))}}var u={components:{ConfirmationModal:r.a,AddNewsModal:s.a},props:{isAdmin:{type:Boolean}},computed:{stocks:function(){return this.$store.getters.stocks},headers:function(){var t=[{text:"Наименование",value:"title",sortable:!1},{text:"Дата создания",value:"date",sortable:!1},{text:"Тип",value:"type",sortable:!1},{text:"Статус",value:"status",sortable:!1},{text:"Баннер",value:"image",sortable:!1,align:"center"}];return this.isAdmin&&t.push({text:"Действие",value:"action",sortable:!1}),t}},data:function(){return{modalKey:0,currentStock:null,modalMessage:"",deleteModal:!1,editId:null,hideModal:!1,addModal:!1,editModal:!1,search:""}},methods:{showDeleteModal:function(t){this.currentStock=t,this.deleteModal=!0},showHideModal:function(t){this.currentStock=t,this.currentStock.is_visible?this.modalMessage="Вы действительно хотите скрыть данную акцию?":this.modalMessage="Вы действительно хотите показать данную акцию?",this.hideModal=!0},showEditModal:function(t){this.editId=t.id,this.editModal=!0},closeDeleteModal:function(){this.deleteModal=!1},closeHideModal:function(){this.hideModal=!1},closeAddModal:function(){this.addModal=!1,this.modalKey++},closeEditModal:function(){this.editModal=!1,this.editId=null},stockCreated:function(){this.addModal=!1,Object(i.a)("Акция успешно добавлена!"),this.modalKey++,this.currentStock=null},stockEdited:function(){this.editModal=!1,Object(i.a)("Акция успешно обновлена!"),this.editId=null},deleteStock:function(){var t=this;return d(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch(c.a.DELETE_STOCK,t.currentStock.id);case 2:t.currentStock=null,t.deleteModal=!1;case 4:case"end":return e.stop()}}),e)})))()},changeStockStatus:function(){var t=this;return d(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.hideModal=!1,e.next=3,t.$store.dispatch(c.a.CHANGE_STOCK_STATUS,{id:t.currentStock.id,is_visible:!t.currentStock.is_visible});case 3:Object(i.a)("Акция успешно обновлена!"),t.currentStock=null;case 5:case"end":return e.stop()}}),e)})))()}}},v=n("KHd+"),f=Object(v.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"d-flex justify-content-between"},[t.isAdmin?n("v-btn",{staticClass:"button-add",attrs:{color:"primary"}},[t._v("\n            Экспорт данных\n            "),n("v-icon",[t._v("mdi-file-excel-box")])],1):t._e(),t._v(" "),t.isAdmin?n("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.addModal=!0}}},[t._v("\n            Добавить баннер\n            "),n("v-icon",[t._v("mdi-plus")])],1):t._e()],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-spacer"),t._v(" "),n("v-text-field",{staticClass:"mb-2",attrs:{clearable:"","append-icon":"mdi-account-search",label:"Поиск","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),t.stocks?n("v-data-table",{attrs:{"no-results-text":"Нет результатов","no-data-text":"Нет данных","footer-props":{"items-per-page-options":[10,15,{text:"Все",value:-1}],"items-per-page-text":"Записей на странице"},headers:t.headers,search:t.search,items:t.stocks},scopedSlots:t._u([{key:"item.image",fn:function(t){var e=t.item;return[n("img",{staticStyle:{"max-width":"200px",height:"auto"},attrs:{src:"../storage/"+e.image,alt:""}})]}},{key:"item.type",fn:function(e){var o=e.item;return[n("span",[t._v(t._s(null===o.service_id?"Акция":"Баннер: "+o.service))])]}},{key:"item.status",fn:function(e){return[e.item.is_visible?n("h4",{staticClass:"green--text"},[t._v("Показывается")]):n("h4",{staticClass:"red--text"},[t._v("Скрыто")])]}},{key:"item.action",fn:function(e){var o=e.item;return[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showHideModal(o)}}},[o.is_visible?n("v-icon",[t._v("mdi-eye-off")]):n("v-icon",[t._v("mdi-eye")])],1),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showEditModal(o)}}},[n("v-icon",[t._v("mdi-pencil-outline")])],1),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.showDeleteModal(o)}}},[n("v-icon",[t._v("mdi-delete")])],1)]}},{key:"footer.page-text",fn:function(e){var n=e.pageStart,o=e.pageStop,a=e.itemsLength;return[t._v("\n            "+t._s(n)+"-"+t._s(o)+" из "+t._s(a)+"\n        ")]}}],null,!1,2187396637)}):t._e(),t._v(" "),t.isAdmin?n("ConfirmationModal",{attrs:{message:"Вы действительно хотите удалить выбранную акцию?",state:t.deleteModal,"ok-message":"Удалить"},on:{cancel:t.closeDeleteModal,confirm:t.deleteStock}}):t._e(),t._v(" "),t.isAdmin?n("ConfirmationModal",{attrs:{"ok-message":"Скрыть",message:t.modalMessage,state:t.hideModal},on:{cancel:t.closeHideModal,confirm:t.changeStockStatus}}):t._e(),t._v(" "),t.isAdmin?n("AddNewsModal",{attrs:{title:"Добавление баннера",state:t.addModal},on:{onClose:t.closeAddModal,onSave:t.stockCreated}}):t._e(),t._v(" "),t.isAdmin?n("AddNewsModal",{attrs:{title:"Редактирование баннера","service-id":t.editId,"ok-button":"Сохранить","edit-mode":!0,state:t.editModal},on:{onClose:t.closeEditModal,onSave:t.stockEdited}}):t._e()],1)}),[],!1,null,"3eb0e322",null);e.a=f.exports},ootA:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return u}));var o=n("o0o1"),a=n.n(o),i=n("vDqi"),s=n.n(i);function r(t,e,n,o,a,i,s){try{var r=t[i](s),c=r.value}catch(t){return void n(t)}r.done?e(c):Promise.resolve(c).then(o,a)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function s(t){r(i,o,a,s,c,"next",t)}function c(t){r(i,o,a,s,c,"throw",t)}s(void 0)}))}}function l(t){return d.apply(this,arguments)}function d(){return(d=c(a.a.mark((function t(e){var n,o,i,r=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"file",(o=new FormData).append(n,e),i={headers:{"content-type":"multipart/form-data"}},t.next=6,s.a.post("/api/upload",o,i);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(t){return v.apply(this,arguments)}function v(){return(v=c(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new FormData).append("file",e),t.next=4,s.a.post("/api/delete",n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},toHN:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".modal-text[data-v-2adaa561]{margin-top:15px!important;font-size:16px}",""])}}]);